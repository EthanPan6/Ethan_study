## 退出node程序的方式

+ 1. 当在控制台中运行程序时，可以使用 ctrl-C 将其关闭
+ 2. `process` 核心模块提供了一种便利的方法，可以以编程的方式退出 Node.js 程序：`process.exit()`。

### 强制终止`process.exit()`

使用该命令后任何待处理的回调、仍在发送中的任何网络请求、任何文件系统访问、或正在写入 stdout 或 stderr 的进程，所有这些都会被立即非正常地终止。

可以传入一个整数，向操作系统发送退出码,默认情况下，退出码为 0，表示成功。 不同的退出码具有不同的含义，可以在系统中用于程序与其他程序的通信。

## 获取命令行参数

```js
process.argv.forEach((val, index) => {
    console.log(`${index}: ${val}`)
})
```
+ 第一个参数是 node 命令的完整路径。
+ 第二个参数是正被执行的文件的完整路径。
+ 所有其他的参数从第三个位置开始,每一个空格后为一个参数。

可以通过创建一个排除了前两个参数的新数组来仅获取其他的参数
```js
const args = process.argv.slice(2)
```
如果需要对参数进行解析,可以使用 minimist 库(`npm install minimist`)
```js
const args = require('minimist')(process.argv.slice(2))
args['name'] //joe
```
但是,需要在每个参数名称之前使用双破折号
```cmd
node app.js --name=joe
```

## 控制台命令

Node.js 提供了 console 模块，该模块提供了大量非常有用的与命令行交互的方法。
它基本上与浏览器中的 console 对象相同。

### log基础输出

```js
console.log('我的%s已经%d岁', '猫', 2)
```
+ %s 会格式化变量为字符串
+ %d 会格式化变量为数字
+ %i 会格式化变量为其整数部分
+ %o 会格式化变量为对象

### 清空控制台
`console.clear()` 会清除控制台（其行为可能取决于所使用的控制台）。

### 元素计数

`console.count()` 是一个便利的方法

```js
const x = 1
const y = 2
const z = 3
console.count('x 的值为 ' + x + ' 且已经检查了几次？')
console.count('x 的值为 ' + x + ' 且已经检查了几次？')
console.count('y 的值为 ' + y + ' 且已经检查了几次？')

const oranges = ['橙子', '橙子']
const apples = ['苹果']
oranges.forEach(fruit =>console.count(fruit))
apples.forEach(fruit =>console.count(fruit))
```
输出结果
```cmd
x 的值为 1 且已经检查了几次？: 1
x 的值为 1 且已经检查了几次？: 2
y 的值为 2 且已经检查了几次？: 1
橙子: 1
橙子: 2
苹果: 1
```

### 打印堆栈踪迹

在某些情况下，打印函数的调用堆栈踪迹很有用，可以回答以下问题：如何到达代码的那一部分？

可以使用 `console.trace()` 实现

```js
const function2 = () => console.trace()
const function1 = () => function2()
function1()
```

### 计算耗时

可以使用 `time()` 和 `timeEnd()` 轻松地计算代码运行所需的时间
+ 当`time()` 和 `timeEnd()`都不传入参数是,默认计时器名字为'default`
+ `time()` 和 `timeEnd()`需要传入相同的参数时才能正确的计算耗时

### 输出着色

可以使用转义序列在控制台中为文本的输出着色。 转义序列是一组标识颜色的字符

```js
console.log('\x1b[33m%s\x1b[5m', '你好')
console.log('\x1b[42;33m%s\x1b[5m', '你好')
```

语法
```js
console.log('\x1b[33m%s\x1b[5m', '你好')
console.log('\x1b[字背景颜色；文字颜色%s\x1b[0m', '你好')
```
+ 上面语法是自己类比出来的,具体语法未知

参考[ANSI转义序列以及输出颜色字符详解](https://www.cnblogs.com/xiaoqiangink/p/12718524.html)

### 输出着色2

[Chalk](https://github.com/chalk/chalk) 是一个这样的库(`npm install chalk`)，除了为其着色外，它还有助于其他样式的设置（例如使文本变为粗体、斜体或带下划线）。

```js
const chalk = require('chalk')
console.log(chalk.yellow('你好'))
```

### 创建进度条

[Progress](https://www.npmjs.com/package/progress) 是一个很棒的软件包，可在控制台中创建进度条。 使用 `npm install progress` 进行安装。

以下代码段会创建一个 10 步的进度条，每 100 毫秒完成一步。 当进度条结束时，则清除定时器：
```js
const ProgressBar = require('progress')

const bar = new ProgressBar(':bar', { total: 10 })
const timer = setInterval(() => {
  bar.tick()
  if (bar.complete) {
    clearInterval(timer)
  }
}, 100)
```
## 与命令行交互

Node.js 提供了 `readline` 模块来执行以下操作：每次一行地从可读流（例如 `process.stdin` 流，在 Node.js 程序执行期间该流就是终端输入）获取输入。
```js
const readline = require('readline').createInterface({
  input: process.stdin,
  output: process.stdout
})

readline.question(`你叫什么名字?`, name => {
  console.log(`你好 ${name}!`)
  readline.close()
})
```
`question()` 方法会显示第一个参数（即问题），并等待用户的输入。 当按下回车键时，则它会调用回调函数。

在此回调函数中，使用`readline.close()`关闭了 readline 接口。

### 其他交互库

+ `readline-sync`
+ `inquirer`(推荐)

这两个库支持异步输入输出,隐藏密码等

```js
var readlineSync = require('readline-sync');
var userName = readlineSync.question('May I have your name? ');
console.log('Hi ' + userName + '!');
var favFood = readlineSync.question('What is your favorite food? ', {
    hideEchoBack: true // The typed text on screen is hidden by `*` (default).
});
console.log('Oh, ' + userName + ' loves ' + favFood + '!');
```

```js
const inquirer = require('inquirer')
inquirer.prompt({
    type: 'input',
    name: 'name',
    message: "你叫什么名字?"
  }).then(answers => {
  console.log(`你好 ${answers['name']}!`)
})
```

**貌似三个库有冲突**

## NPM管理

### 下载

#### 安装所有依赖

如果项目具有 package.json 文件，则通过运行：
```cmd
npm install
```
它会在 `node_modules` 文件夹（如果尚不存在则会创建）中安装项目所需的所有东西。

### 安装单个软件包

也可以通过运行以下命令安装特定的软件包：
```cmd
npm install <package-name>
```
通常会在此命令中看到更多标志：

+ --save 安装并添加条目到 package.json 文件的 dependencies。
+ --save-dev 安装并添加条目到 package.json 文件的 devDependencies。
区别主要是，devDependencies 通常是开发的工具（例如测试的库），而 dependencies 则是与生产环境中的应用程序相关。

### 更新软件包

通过运行以下命令，更新也变得很容易：
```cmd
npm update
```
npm 会检查所有软件包是否有满足版本限制的更新版本。

也可以指定单个软件包进行更新：
```cmd
npm update <package-name>
```

### 运行任务

package.json 文件支持一种用于指定命令行任务（可通过使用以下方式运行）的格式：
```cmd
npm run <task-name>
```
可以在package.json中对某些命令进行取别名的方式然后进行相关操作
```json
{
  "scripts": {
    "watch": "webpack --watch --progress --colors --config webpack.conf.js",
    "dev": "webpack --progress --colors --config webpack.conf.js",
    "prod": "NODE_ENV=production webpack -p --config webpack.conf.js",
  },
}
```
因此可以运行如下，而不是输入那些容易忘记或输入错误的长命令
```cmd
npm run watch
npm run dev
npm run prod
```

### 安装包位置

当使用 npm 安装软件包时，可以执行两种安装类型：
+ 本地安装(默认)
+ 全局安装(-g)
默认情况下，当输入 npm install 命令时，例如：
```js
npm install lodash
```
软件包会被安装到当前文件树中的 node_modules 子文件夹下。

在这种情况下，npm 还会在当前文件夹中存在的 package.json 文件的 dependencies 属性中添加 lodash 条目。

使用 -g 标志可以执行全局安装
`npm root -g` 命令会告知其在计算机上的确切位置